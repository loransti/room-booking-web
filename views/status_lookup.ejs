<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Find Booking Â· Room Manager</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
  <style>
    :root { --bg:#f6f7f9; --card:#fff; --border:#e6e8ec; --text:#0a0a0a; --muted:#667085; --accent:#007aff; --radius:14px; --shadow:0 6px 20px rgba(0,0,0,0.06); }
    body.dark { --bg:#0f1115; --card:#181a1f; --border:#2a2e35; --text:#e6e8ed; --muted:#9aa4b2; --accent:#7c9cff; }
    body { background: var(--bg); color: var(--text); font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; }
    .wrap { min-height: 100vh; display:grid; place-items:center; padding: 20px; }
    .card { background: var(--card); border:1px solid var(--border); border-radius: var(--radius); box-shadow: var(--shadow); max-width: 640px; width:100%; }
  </style>
</head>
<body>
  <div class="wrap">
    <button class="btn btn-link position-absolute" style="top:12px; right:12px" id="themeToggle" title="Toggle dark mode"><i class="bi bi-moon"></i></button>
    <div class="card">
      <div class="card-body p-4 p-sm-5">
        <h3 class="mb-3">Find Your Booking</h3>
        <form method="get" action="/status" class="d-flex gap-2 mb-3">
          <input class="form-control" name="code" placeholder="Enter reservation code (e.g., ABC123)" required>
          <button class="btn btn-primary">Search</button>
        </form>
        <div class="mb-2">Saved on this device:</div>
        <ul id="saved" class="list-group"></ul>
      </div>
    </div>
  </div>
  <script>
    (function(){
      const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
      const saved = localStorage.getItem('rm-dark');
      const isDark = saved === 'true' || (saved === null && prefersDark);
      if (isDark) document.body.classList.add('dark');
      const btn = document.getElementById('themeToggle');
      if (btn) btn.addEventListener('click', function(){
        document.body.classList.toggle('dark');
        localStorage.setItem('rm-dark', document.body.classList.contains('dark'));
        this.querySelector('i').className = document.body.classList.contains('dark') ? 'bi bi-sun' : 'bi bi-moon';
      });
    })();
  </script>
  <script>
    const list = JSON.parse(localStorage.getItem('rm-reservations')||'[]');
    const ul = document.getElementById('saved');
    if (list.length === 0) {
      ul.innerHTML = '<li class="list-group-item text-muted">No saved reservations on this device.</li>';
    } else {
      list.sort((a,b)=>b.savedAt-a.savedAt).forEach(item => {
        const li = document.createElement('li');
        li.className = 'list-group-item d-flex justify-content-between align-items-center';
        li.innerHTML = `<span><code>${item.code}</code></span><a class="btn btn-sm btn-outline-primary" href="${item.link}">Open</a>`;
        ul.appendChild(li);
      });
    }
  </script>
</body>
</html>
